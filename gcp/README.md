### GCP Tag collector

`https://cloud.google.com/python/docs/reference`

### Installation

Clone this repo

`git clone https://github.com/Forcepoint/fp-NGFW-dynamic-tags`

Setup a virtualenv where the application packages can be installed:

```
cd fp-NGFW-dynamic-tags/gcp
python3 -m venv env
```

NOTE: Depending on your version of python and OS, the above method for creating
a virtualenv may be different.

Enter into virtual env:

`source env/bin/activate`

Update pip:

`python3 -m pip install --upgrade pip`

Install the packages

`pip3 install -r requirements.txt`

### Configure credentials for IAM policy

Go to IAM & Admin and select `Service Accounts`

Under service accounts, create a new name and description and give Grant
ReadOnly access to compute resources

Once your service account is created, you can download the json formatted
credential config file which will be required for auth to GCP.

#### Running the program

By default, GCP credentials are retrieved from a file in the local directory
named gcp.json

The `gcp.json` is the service credential authentication information required
for this API client to connect and should have been downloaded as part of
the credential creation. This is generated by GCP and can be exported in
json format.

In addition, Forcepoint SMC credentials are required to bridge
the connection to SMC. By default, you can put SMC auth ENV vars in .env or
you can configure ~.smcrc as you normally would use FP smcpython.

*NOTE*: You can optionally put your SMC env vars in .env within the same dir
to identify you SMC credential information. An example `.env.ex` has been
provided for that purpose.

### Examples

Discover any VMs within project ID 'xyzx-12345', but do not sync, just show
results of elements detected (by adding --report_only):

`python3 main.py --project_id xyzx-12345 --report_only`


